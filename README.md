# SchrodingerWrapper

## Introduction
Schrodinger is a commercial software for ligand discovery and protein visualisation purposes (https://www.schrodinger.com/). 

This repo contains python code which incorporates the latest Schrodinger API.

For this branch, a pipeline is constructed to perform side-chain modelling and mutation with SCWRL (http://dunbrack.fccc.edu/Software.php), the pdb coordinates generated by SCWRL would be fed into Schrodinger for optimisation purposes.

Note that README for this branch is different from master and docking branches. The use case for this branch is mainly catered for Dr Shreyas in the Ligand Discovery Lab of Bioinformatics Institute, ASTAR.

## Input and Output of the pipeline

Input: Protein DataBank (PDB) files are fed into the pipeline, together with optional hetero-atom/sequence text files.

Output: Maestro files will be generated at the end. Note that maestro files are only compatible with Schrodinger programme.

## Prerequisites
1. Activate the schrodinger environment, this programme uses the schrodinger software.
2. `pip install -r requirements.txt`, if you have a different python software, spin up a virtual environment prior to installing the libraries in requirements.txt. 
3. You have a SCWRL executable present in your computer.

## Invoking the Commandline application
`python3 main.py -h` to see a list of flags available.

## The flags
  1. -s  : scwrl file **path**, comma delimited text file which instructs which pdb file (**mandatory**), het atm file (**optional**) and seq file (**optional**) will be used for scwrl
  2. -pdb : a **path** to a folder which contains pdb file(s) for scwrl
  3. -exe : **path** to a scwrl exe file
  4. -check_cu : to check the charge of Cu
  5. -cross_link : to enable cross linkling
  6. -zero_bond : zero bonding with Cu

## File Directory
Project Folder is already predefined, so that users will not be required to define their own file structues.

### The predefined folders
1. files: to store fix.txt, mut.txt
2. het_atm: to store het atoms in .txt files
3. pdb_f (with scwrl_out and for_schrod as subfolders): to store pdb files for processing.
4. seq_f: to store primary amino acid in .txt files for mutation with SCWRL.

### The scwrl.txt file
To make the pipeline user friendly, users will interact directly with scwrl.txt.

### Structure of scwrl.txt
pdb:your_pdb.pdb,fix:your_fix.txt,mut:your_mut2.txt,het:your_het_atm.txt,<amino acid residue number>|atom or functional groups to change|new element|new element type (pre-schrodinger process)
  
For example: pdb:2EIE.pdb,fix:fix.txt,mut:mut.txt,het:het_atm_2EIE.txt,272|OH|F|F
  
'pdb:' tells the pipeline a pdb file is present and it should look for the file in the pdb_f folder.
Furthermore, by telling the pipeline which files are 'fix', 'mut' and 'het', we inform the pipeline which 'fix', 'mut' and 'het' files are appropriate for a pdb file.

From the example, we know that het_atm_2EIE.txt is the correct het_atom file for 2EIE.pdb

### The logic of the predefined folders
pdb_f contains input pdb files for the pipeline.

het_atm and seq_f contain the optional files that will be fed into the pipeline if applicable.

files contain text files which tells the pipeline which amino acid residues to mutate and which residues SCWRL should not model.

Note:
1. scwrl_out stores pdb files generated by SCWRL. Since the user requested OH group of Tyrosine-272 to be changed into Fluorine, files from scwrl_out will be modified and stored in for_schrod, before sending the files into Schrodinger.
2. There can be multiple fix.txt and mut.txt files, but their namings should be distinguishable for the user.
3. files in seq_f are automatically generated by the python code.
