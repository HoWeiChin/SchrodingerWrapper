# SchrodingerWrapper

## Prerequisites
1. Activate the schrodinger environment, this programme uses the schrodinger software.
2. `pip install -r requirements.txt`, if you have a different python software, spin up a virtual environment prior to installing the libraries in requirements.txt. 

## Invoking the Commandline application
`python3 main.py -h` to see a list of flags available.

## The flags
  1. -s  : scwrl file **path**, comma delimited text file which instructs which pdb file (**mandatory**), het atm file (**optional**) and seq file (**optional**) will be used for scwrl
  2. -pdb : a **path** to a folder which contains pdb file(s) for scwrl
  3. -het : a **path** to a folder which contains het-atom txt files for scwrl
  4. -mut : invoke this flag **only** if you wan scwrl to perform mutation 
  5. -exe : **path** to a scwrl exe file 
  6. -m   : mutation file for schrodinger, must be used in conjuction with -het flag. 

## File Directory
In your project folder you will need to supply:
1. a pdb folder.
2. a het_atm folder, if you wish to include het atoms when invoking scwrl.

\
The following folders will be automatically generated by the programme:
1. scwrl_out, which is a sub-folder for the pdb folder you have supplied to the programme. scwrl_out stores the output of scwrl. the files in this sub-folder serve as an input to generate files in for_sch_opt folder.
2. seq_f, this folder will be created in the same directory of main.py if you activate the mutation flag for scwrl.
3. for_sch_opt, which is a sub-folder for the pdb folder you have supplied to the programme. Files in for_sch_opt serve as input to generate .mae files.

## The scwrl file
Each row of the scwrl file looks like: <pdb_file>, <het_atom_file>, <mutation>.
\
<mutation> has the following format: <residue-number>:<mutant amino acid>:<polypeptide chain>
Example: `1og2A.pdb,het_atm.txt,31:E:A`
\
Just a reminder, only pdb_file is compulsory, het_atom file and mutation are optional inputs.
\
Take note that the application only process a row of the scwrl file when there is 2 commas.
\
If, for example, this is present in the scwrl file: `1gog.pdb,`, the application will skip that line.
  
If you would like to omit an optional input, do something like:
1. `1gog.pdb,,` (if you wish to use scwrl without the het_atom file and mutation)
2. `1gog.pdb,het_atm.txt,` (if you wish to use scwrl with a pdb and a het_atom file only)

Note that, how you order <pdb_file>, <het_atom_file>, <mutation> does not matter as the applcation has a logic to sort them. 
But, where possible, do provide the input in the following order: <pdb_file>, <het_atom_file>, <mutation>.
Also, note that if you supply a het_atom file without supplying the het_atm flag, the application will skip over a pdb file associated with a het_atom file.
  
## The mutation file (for -m flag)
The original intention was to enable multiple mutations for a pdb file, where multiple mutations are delimited by a '|'. Hence, it's mandatory to supply '|' inside the mutation file.
But, due to a bug, the application only perform one mutation for a pdb file.

## Example on using Scwrl without Schrodinger routine:
### 1. Scwrl with mutation
`python3 main.py -s scwrl.txt -pdb pdb_f -exe /home/howc/Desktop/SWRL/Scwrl4 -mut`
### 2. Scwrl without mutation
`python3 main.py -s scwrl.txt -pdb pdb_f -exe /home/howc/Desktop/SWRL/Scwrl4`
### 3. Scwrl and Schrodinger
` python3 main.py -s scwrl.txt -pdb pdb_f -exe /home/howc/Desktop/SWRL/Scwrl4 -mut -m 2_mutations.txt -het het_atm`
## Future
Set up CI/CD, code refactoring. More unit-testing, current test cases are minimal. Resolve mutation bug.
