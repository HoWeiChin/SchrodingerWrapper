# SchrodingerWrapper

## Prerequisites
1. Activate the schrodinger environment, this programme uses the schrodinger software.
2. `pip install -r requirements.txt`, if you have a different python software, spin up a virtual environment prior to installing the libraries in requirements.txt. 

## Invoking the Commandline application
`python3 main.py -h` to see a list of flags available.

## The flags
  1. -s  : scwrl file **path**, comma delimited text file which instructs which pdb file (**mandatory**), het atm file (**optional**) and seq file (**optional**) will be used for scwrl
  2. -pdb : a **path** to a folder which contains pdb file(s) for scwrl
  3. -het : a **path** to a folder which contains het-atom txt files for scwrl
  4. -mut : invoke this flag **only** if you wan scwrl to perform mutation 
  5. -exe : **path** to a scwrl exe file 
  6. -m   : mutation file for schrodinger, must be used in conjuction with -het flag. 
  7. -check_cu : to check the charge of Cu
  8. -cross_link : to enable cross linkling
  9. -zero_bond : zero bonding with Cu

## File Directory
In your project folder you will need to supply:
1. a pdb folder.
2. a het_atm folder, if you wish to include het atoms when invoking scwrl.

\
The following folders will be automatically generated by the programme:
1. scwrl_out, which is a sub-folder for the pdb folder you have supplied to the programme. scwrl_out stores the output of scwrl. the files in this sub-folder serve as an input to generate files in for_sch_opt folder, if the -m flag is provided.
2. seq_f, this folder will be created in the same directory of main.py if you activate the mutation flag for scwrl.
3. for_sch_opt, which is a sub-folder for the pdb folder you have supplied to the programme. 

## The scwrl file
### The purpose of scwrl file
The scwrl file tells the application how many pdb files will need to be processed by scwrl, together with optional inputs like a het atom file or any mutation to be applied by scwrl.
Note that, we only support point amino acid mutation currently.

### The format
Each row of the scwrl file looks like: pdb_file, het_atom_file, mutation.
Example: `1og2A.pdb,het_atm.txt,31:E:A`
\
\
Subsequently, mutation has the following format: residue-number:mutant amino acid:polypeptide chain
Example: `31:E:A`, this means that the 31st residue of the A polypeptide chain of a protein will be turned into a Glutamate.
\
\
The pdb_file is a compulsory input, while het_atom file and mutation are optional inputs.
\
\
Also take note that the application only processes a row of the scwrl file when there are 2 commas, else that row will be skipped.
\
\
For example, if this row is present in the scwrl file: `1gog.pdb,`, the application will skip that line and 1gog.pdb will not be processed.
  
Hence, if you would like to omit an optional input, do provide the inputs as follow:
1. `1gog.pdb,,` (if you wish to use scwrl without the het_atom file and mutation)
2. `1gog.pdb,het_atm.txt,` (if you wish to use scwrl with a pdb and a het_atom file only)

Note that, the order of <pdb_file>, <het_atom_file>, <mutation> is inconsequential as the applcation has a logic to sort them. 
Also, note that if you supply a het_atom file without supplying the het_atm flag, the application will skip over a pdb file associated with a het_atom file.
 
## The mutation file (for -m flag)
### The purpose of mutation file
Each row depicts a change of an atom of an amino acid residue to a new atom.

### The format
Eg: `154,O,F,F|`, where 154 is the amino acid residue number, O is the oxygen atom of residue 154 which will be changed to F, a fluorine atom and the 2nd F is the element type.

Note that each row of the mutation file corresponds to a sorted order of pdb files in the pdb folder.
Also note that, `|` is meant to separate multiple mutations of a pdb file, but due to a bug, only one mutation is allowed.

## Example on using Scwrl without Schrodinger routine:
### 1. Scwrl with mutation
`python3 main.py -s scwrl.txt -pdb pdb_f -exe /home/howc/Desktop/SWRL/Scwrl4 -mut`
### 2. Scwrl without mutation
`python3 main.py -s scwrl.txt -pdb pdb_f -exe /home/howc/Desktop/SWRL/Scwrl4`
### 3. Scwrl and Schrodinger
` python3 main.py -s scwrl.txt -pdb pdb_f -exe /home/howc/Desktop/SWRL/Scwrl4 -mut -m 2_mutations.txt -het het_atm`
## Future
Set up CI/CD, code refactoring. More unit-testing, current test cases are minimal. Resolve bug related to mutation file.. 
